# envs
The tools needed to used in shell scripts.
# Installation
```
#tools for processing reads and assembly
mamba env create -f requirements.yml
conda activate tools
```
```
#identification
mamba env create -f VirFinder.yml
conda activate VF
mamba env create -f vibrant.yml
conda activate vibrant
mamba env create -f virsorter2.yml
conda activate vs2
```
# Shell scripts
Shell scripts used in genome assembly, viral recognition and other analysis.

# Rawdata processing
Raw next generation sequencing of viral reads were processed with **Trimmomatic v0.38** (with parameter LEADING:3 TRAILING:3 SLIDINGWINDOW:15:30 MINLEN:50) to remove adaptors and trim low-quality bases; reads of 50 bp or less after trimming were discarded. Putative human reads were identified from the trimmed reads by aligning the latter to the human reference genome (hg38; GCA_000001405.15) using **Bowtie2** (v2.4.2, --end-to-end) with default parameters and removed from further analysis.

# Assembly
* The method in manuscript is consistent with Zeng S, et al. The quality-controlled reads of bulk and VLP were assembled with **MegaHIT v1.1.3** (default parameters except option “-min-contig-len 1000”).

# Viral identification and acquisition of non-redundant vOTUs
* The method for viral gene identification is consistent with Zeng S, et al. After assembly, all contigs > 3kb in length in each sample were submitted to **VirSorter v2.2.3, VirFinder v1.1 and VIBRANT v1.2.1** for identification of viral populations (The parameters is the same as the Methods in Zeng S, et al.). Thereafter, the viral populations were filtered by **CheckV v1.0.1**, and further dereplication by **CD-HIT v4.6.8** (parameters: -c 0.99 -g 1 -M 0 -d 0 -n 10) to obtain viral sequences based on the two methods. The nucleotide BLAST database of both the viral sequences was built by makeblastdb (option “-dbtype nucl”) from **blast v2.13.0**, and the pairwise comparisons were generated by blasting all viral sequences all-against-all with **blastn** (option “-max_target_seqs 10,000”). Finally, clustering of viral sequences into species-level vOTUs was carried out using two custom scripts (anicalc.py and aniclust.py) from the CheckV, with thresholds set at 95% ANI and 85% AF (options “-min_ani 95, -min_tcov 85, -min_qcov 0”).

# R scripts
Shell scripts used in abundance calculation and figure generation.
